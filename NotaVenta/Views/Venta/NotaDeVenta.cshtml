@using UTIL.Models;
@using UTIL.Objetos;
@using NotaVenta.UTIL;
@{

    if (((BaseController)this.ViewContext.Controller).codigoVendedorUsuario() == null)
    {
        var URL = System.Configuration.ConfigurationManager.AppSettings.Get("url");
        Response.Redirect(URL);
    }

    ViewBag.Title = "Nota De Pedido";
    string anterior = ViewBag.Anterior;
    string NomAux = ViewBag.NomAux;
    string CodAux = ViewBag.CodAux;
    string RutAux = ViewBag.RutAux;
    string VenCodigo = ((BaseController)this.ViewContext.Controller).codigoVendedorUsuario();
    string VenDes = SessionVariables.SESSION_DATOS_USUARIO.VenDes.ToString();
    string user = SessionVariables.SESSION_DATOS_USUARIO.Nombre.ToString();
    List<CondicionVentasModels> condicion = ViewBag.condicion;
    int vcontacto = ViewBag.vcontactos;
    int vdirec = ViewBag.vdirecc;
    List<ClientesModels> listcontacto = ViewBag.contactos;
    List<ListaDePrecioModels> listap = ViewBag.lista;
    List<CentrodeCostoModels> cc = ViewBag.cc;
    CentrodeCostoModels ccDefecto = cc.Where(m => Convert.ToString(m.DescCC).ToLower().Contains("santiago")).FirstOrDefault();
    List<CanalVentaModels> canalVentas = ViewBag.canalVentas;

    List<DireccionDespachoModels> direc = ViewBag.direccion;
    string fechaactual = DateTime.Now.ToString("yyyy-MM-dd");
    DateTime dia = DateTime.Now;
    dia = dia.AddDays(1);
    string fechamin = (DateTime.Now.Year + "-" + DateTime.Now.ToString("MM") + "-" + dia.ToString("dd")).ToString();
    string codigo = ViewBag.codigo;
    string nombre = ViewBag.nombre;
    string tituloanterior = ViewBag.anterior;
    string pageantegior = ViewBag.page;
    CreditoModel credito = ViewBag.Credito;
    int numero1 = 1;
    int total1 = 0;
    double impuesto = 0;
    double totalfinal = 0;
    int id = SessionVariables.SESSION_DATOS_USUARIO.IdUsuario;
    double SaldoTotal = ViewBag.SaldoTotal;

    ParametrosModels parametros = ViewBag.Parametros;

    double PorcentajeAtributoDescuento = Convert.ToDouble(ViewBag.ValorAtributo);
    VendedoresSoftlandModels vendedorCliente = ((VendedoresSoftlandModels)ViewBag.VendedorCliente);
}


<!-- ================== BEGIN PAGE CSS STYLE ================== -->
<link href="~/Content/assets/plugins/x-editable-bs4/dist/bootstrap4-editable/css/bootstrap-editable.css" rel="stylesheet" />
<link href="~/Content/assets/plugins/x-editable-bs4/dist/inputs-ext/address/address.css" rel="stylesheet" />
<link href="~/Content/assets/plugins/x-editable-bs4/dist/inputs-ext/typeaheadjs/lib/typeahead.js-bootstrap.css" rel="stylesheet" />
<link href="~/Content/assets/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet" />
<link href="~/Content/assets/plugins/bootstrap3-wysihtml5-bower/dist/bootstrap3-wysihtml5.min.css" rel="stylesheet" />
<link href="~/Content/assets/plugins/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css" rel="stylesheet" />
<link href="~/Content/assets/plugins/bootstrap-datepicker/dist/css/bootstrap-datepicker3.min.css" rel="stylesheet" />
<link href="~/Content/assets/plugins/select2/dist/css/select2.min.css" rel="stylesheet" />
<!-- ================== END PAGE CSS STYLE ================== -->
<!-- begin page-header -->
<h1 class="page-header">
    Nota de Pedido
</h1>
<!-- end page-header -->
<!-- begin row -->
<div class="row" id="divFormulacioCompletoIngresoDatos">
    <input type="hidden" id="EditaPrecioProducto" value="@parametros.EditaPrecioProducto.ToString()" />
    <input type="hidden" id="MuestraCondicionVentaCliente" value="@parametros.MuestraCondicionVentaCliente.ToString()" />
    <input type="hidden" id="MuestraCondicionVentaTodos" value="@parametros.MuestraCondicionVentaTodos.ToString()" />
    <input type="hidden" id="EditaDescuentoProducto" value="@parametros.EditaDescuentoProducto.ToString()" />
    <input type="hidden" id="MaximoDescuentoProducto" value="@parametros.MaximoDescuentoProducto" />
    <input type="hidden" id="CantidadDescuentosProducto" value="@parametros.CantidadDescuentosProducto" />
    <input type="hidden" id="MuestraStockProducto" value="@parametros.MuestraStockProducto.ToString()" />
    <input type="hidden" id="StockProductoEsMasivo" value="@parametros.StockProductoEsMasivo.ToString()" />
    <input type="hidden" id="StockProductoEsBodega" value="@parametros.StockProductoEsBodega.ToString()" />
    <input type="hidden" id="StockProductoCodigoBodega" value="@parametros.StockProductoCodigoBodega" />
    <input type="hidden" id="ControlaStockProducto" value="@parametros.ControlaStockProducto.ToString()" />
    <input type="hidden" id="ManejaTallaColor" value="@parametros.ManejaTallaColor.ToString()" />
    <input type="hidden" id="ManejaDescuentoTotalDocumento" value="@parametros.ManejaDescuentoTotalDocumento.ToString()" />
    <input type="hidden" id="CantidadDescuentosTotalDocumento" value="@parametros.CantidadDescuentosTotalDocumento" />
    <input type="hidden" id="ManejaLineaCreditoVendedor" value="@parametros.ManejaLineaCreditoVendedor.ToString()" />
    <input type="hidden" id="ManejaLineaCreditoAprobador" value="@parametros.ManejaLineaCreditoAprobador.ToString()" />
    <input type="hidden" id="ManejaCanalVenta" value="@parametros.ManejaCanalVenta.ToString()" />
    <input type="hidden" id="PermiteModificacionCondicionVenta" value="@parametros.PermiteModificacionCondicionVenta.ToString()" />
    <input type="hidden" id="AtributoSoftlandDescuentoCliente" value="@parametros.AtributoSoftlandDescuentoCliente" />
    <input type="hidden" id="PermiteCrearDireccion" value="@parametros.PermiteCrearDireccion.ToString()" />
    <input type="hidden" id="MuestraUnidadMedidaProducto" value="@parametros.MuestraUnidadMedidaProducto.ToString()" />
    <input type="hidden" id="PorcentajeAtributoDescuento" value="@ViewBag.ValorAtributo" />


    <input type="hidden" id="urlObtieneProductosPorListaPrecio" value="@Url.Action("ObtieneProductosPorListaPrecio", "Venta" )" />
    <input type="hidden" id="urlPorcentaje" value="@Url.Action("Porcentaje", "Venta" )" />
    <input type="hidden" id="urlBusquedaProducto" value="@Url.Action("ProductSearch","Venta")" />
    <input type="hidden" id="urlBusquedaRapidaProducto" value="@Url.Action("QuickProductSearch", "Venta")" />
    <input type="hidden" id="urlMultiplicar" value="@Url.Action("Multiplicar", "Venta")" />
    <input type="hidden" id="urlDetalleNotaVenta" value="@Url.Action("Detallenv", "Venta" )" />
    <input type="hidden" id="urlAgregarContacto" value="@Url.Action("AgregarContacto", "Venta")" />
    <input type="hidden" id="urlAgregarNotaVenta" value="@Url.Action("AgregarNV", "Venta" )" />
    <input type="hidden" id="urlCalcularFila" value="@Url.Action("CalcularFila", "Venta")" />
    <input type="hidden" id="urlCalcularProductosAgregados" value="@Url.Action("CalcularProductosAgregados", "Venta")" />
    <input type="hidden" id="urlObtieneTallaColorProducto" value="@Url.Action("ObtieneTallaColorProducto", "Venta")" />
    <div class="row col-lg-12">
        <div class="col-lg-12">
            <div class="panel panel-inverse" data-sortable-id="ui-widget-1">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        Datos del Cliente
                    </h4>
                    <div class="panel-heading-btn">
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>-->
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-success" data-click="panel-reload"><i class="fa fa-redo"></i></a>-->
                        <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i class="fa fa-times"></i></a>-->
                    </div>
                </div>
                <div class="panel-body">
                    <input type="hidden" id="filtrarBusqueda" name="filtrarBusqueda" value="40">
                    <div class="table-responsive form-inline">
                        <table class="table table-profile">
                            <tbody>
                                <tr class="highlight">
                                    <td>Cod. Cliente</td>
                                    <td>
                                        <input type="text" name="nombreCliente" id="nombreCliente" class="form-control" value="@codigo - @nombre" readonly="readonly" tabindex="-1" size="40" />
                                        <input type="hidden" name="txtcliente" id="txtcliente" value="@codigo" readonly="readonly" />
                                    </td>
                                    <td nowrap="nowrap">Vendedor Cliente</td>
                                    <td>
                                        @vendedorCliente.VenDes
                                    </td>
                                    <td nowrap="nowrap">Atendido Por</td>
                                    <td>
                                        @VenDes
                                    </td>
                                </tr>
                                <tr class="highlight">
                                    <td nowrap="nowrap">Contacto</td>
                                    <td>
                                        @{
                                            try
                                            {
                                                if (vcontacto == 1)
                                                {
                                                    <select name="txtcontacto" id="txtcontacto" class="form-control">
                                                        <option selected value=""> -- Seleccione Contacto -- </option>
                                                        @{
                                                            for (int i = 0; i < listcontacto.Count; i++)
                                                            {
                                                                <option value="@listcontacto[i].NomCon" selected> @listcontacto[i].NomCon </option>
                                                            }
                                                        }
                                                    </select>
                                                }
                                                else
                                                {
                                                    <input type="text" name="txtcontacto" id="txtcontacto" class="form-control" value="Sin Contacto" tabindex="-1" />
                                                }
                                            }
                                            catch (Exception)
                                            {
                                                <input type="text" name="txtcontacto" id="txtcontacto" value="" class="form-control" tabindex="-1" />
                                            }
                                        }
                                        <input type="hidden" id="txtVcontacto" name="txtVcontacto" class="form-control" value=@vcontacto>
                                    </td>
                                    <td nowrap="nowrap">Cond. Venta</td>
                                    <td>
                                        <select @Html.Raw(parametros.PermiteModificacionCondicionVenta ? "" : "disabled") name="cbxconven" id="cbxconven" class="form-control" tabindex="4">
                                            <option selected value="-1"> -- Seleccione Cond. Vta -- </option>
                                            @{
                                                for (int i = 0; i < condicion.Count; i++)
                                                {
                                                    <option selected value="@condicion[i].ConVta"> @condicion[i].CveDes </option>
                                                }
                                            }
                                        </select>
                                    </td>
                                    @if (parametros.ManejaListaPrecios)
                                    {
                                        <td nowrap="nowrap">Lista de Precio</td>
                                        <td>
                                            <select name="cbxlista" class="form-control" id="cbxlista" tabindex="7">
                                                <option selected value="-1"> -- Seleccione Lista De Precio -- </option>
                                                @{
                                                    for (int i = 0; i < listap.Count; i++)
                                                    {
                                                        <option value="@listap[i].Codlista" selected> @listap[i].DesLista </option>
                                                    }
                                                }
                                            </select>
                                        </td>
                                    }
                                </tr>
                                <tr class="highlight">
                                    <td nowrap="nowrap">Fecha Pedido</td>
                                    <td><input type="date" class="form-control" name="txtfechapedido" value="@fechaactual" id="txtfechapedido" readonly="readonly" /></td>
                                    <td nowrap="nowrap">Fecha Entrega</td>
                                    <td><input type="date" class="form-control" name="txtfechaentrega" min=@fechamin value=@fechamin id="txtfechaentrega" /></td>
                                    @if (parametros.ManejaCanalVenta)
                                    {
                                        <td nowrap="nowrap">Canal Venta</td>
                                        <td>
                                            <select name="ddlCanalVenta" id="ddlCanalVenta" class="form-control" tabindex="4">
                                                <option selected value="-1"> -- Seleccione Canal de Venta -- </option>
                                                @{
                                                    for (int i = 0; i < canalVentas.Count; i++)
                                                    {
                                                        <option selected value="@canalVentas[i].CanCod"> @canalVentas[i].CanDes </option>
                                                    }
                                                }
                                            </select>
                                        </td>
                                    }
                                </tr>
                                <tr class="highlight">
                                    <td nowrap="nowrap">Observaci&oacute;n</td>
                                    <td><textarea class="form-control" name="txtobservacion" id="txtobservacion" rows="2"> </textarea></td>
                                    <td nowrap="nowrap">Centro de Costo</td>
                                    <td>
                                        <select class="form-control" name="cbxccosto" id="cbxccosto" tabindex="9">
                                            <option selected value="-1"> -- Seleccione Centro de Costo -- </option>
                                            @{
                                                for (int i = 0; i < cc.Count; i++)
                                                {
                                                    <option @Html.Raw(ccDefecto == null ? "" : (cc[i].CodiCC == ccDefecto.CodiCC) ? "selected" : "") value="@cc[i].CodiCC"> @cc[i].DescCC</option>
                                                }
                                            }
                                        </select>
                                    </td>
                                    @if (parametros.ManejaSaldo)
                                    {
                                        <td nowrap="nowrap">Saldo</td>
                                        <td>
                                            <input type="text" class="text-danger form-control" disabled value="@SaldoTotal" />
                                            <button class="btn-primary btn" data-toggle="modal" data-target="#modalSaldo" onclick="ObtenerSaldo('@RutAux')" style="cursor:pointer;"><i class="fas fa-search"></i></button>
                                        </td>
                                    }

                                </tr>
                                @if (parametros.ManejaLineaCreditoVendedor)
                                {
                                    <tr class="highlight">
                                        <td>Credito</td>
                                        <td>
                                            <label id="lblDeudaVencida">@credito.Credito</label>
                                        </td>
                                        <td>Disponible</td>
                                        <td>
                                            <label id="lblDeudaTotal">@credito.Saldo</label>
                                        </td>
                                    </tr>
                                }
                                <tr>
                                    <td>Dirección de Despacho</td>
                                    <td colspan="5">
                                        <div class="row">
                                            <div class="col-lg-10">
                                                @{
                                                    try
                                                    {
                                                        if (vdirec == 1)
                                                        {
                                                            <select class="form-control" name="cbxDireccion" id="cbxDireccion" tabindex="9">
                                                                <option selected value="-1"> -- Seleccione Dirección de Despacho -- </option>
                                                                @{
                                                                    for (int i = 0; i < direc.Count; i++)
                                                                    {
                                                                        <option selected value="@direc[i].NomDch"> @direc[i].DirDch @direc[i].ComDch </option>
                                                                    }
                                                                }

                                                            </select>
                                                        }
                                                        else
                                                        {
                                                            <input class="form-control" type="text" name="cbxDireccion" id="cbxDireccion" value="No Tiene Dirección Asociado" tabindex="-1" readonly="readonly" />
                                                        }

                                                    }
                                                    catch (Exception)
                                                    {

                                                    }
                                                }
                                            </div>
                                            <div class="col-lg-2">
                                                @if (parametros.PermiteCrearDireccion)
                                                {
                                                    <input type="button" id="btnAgregarDireccionDespacho" class="btn btn-primary" value="Agregar Direccion" />
                                                }
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row col-lg-12">
        <div class="col-lg-12">
            <div class="panel panel-inverse" data-sortable-id="ui-widget-2">
                <div class="panel-heading">
                    <h4 class="panel-title">Agregar Producto</h4>
                    <div class="panel-heading-btn">
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>-->
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-success" data-click="panel-reload"><i class="fa fa-redo"></i></a>-->
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>-->
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i class="fa fa-times"></i></a>-->
                    </div>
                </div>
                <div class="panel-body table-responsive ">
                    <input id="hfPrecioUnitarioConDescuento" type="hidden" value="" />
                    <input id="hfSubTotalConDescuento" type="hidden" value="" />
                    <table id="user" class="table table-condensed table-bordered ">
                        <thead>
                            <tr>
                                <th style="display: none">Cod. Rap.</th>
                                <th style=" width: 450px !important">Descripcion/Codigo</th>
                                <th>Cant.</th>
                                @if (parametros.MuestraStockProducto)
                                {
                                    <th>Stock</th>
                                }
                                @if (parametros.MuestraUnidadMedidaProducto)
                                {
                                    <th>U. deM</th>
                                }
                                <th>Neto</th>
                                <th>Sub Total</th>
                                @if (PorcentajeAtributoDescuento > 0)
                                {
                                    <th>Descuento Atributo (@PorcentajeAtributoDescuento%)</th>
                                }
                                <th>Descuen.(%)</th>
                                <th>Total</th>
                                <th>Accion</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="display: none"><a href="javascript:;" id="txtIngresoCodigoRapido" data-type="text" data-pk="1" data-title="Cod Rap"></a></td>
                                <!--<td><a href="javascript:;" id="txtIngresoDescripcionCodigo" data-type="text" data-pk="2" data-title="Descripcion / Codigo"></a></td>-->
                                <td data-select2-id="277"><a href="javascript:;" id="txtIngresoDescripcionCodigo" data-type="select2" data-pk="2" data-value="BS" data-title="Seleccione Producto" class="editable editable-click" style=""></a></td>
                                <td style="text-align: right"><a href="javascript:;" id="txtIngresoCantidad" data-type="text" data-pk="3" data-title="Cantidad">1</a></td>
                                <td style="text-align: right; @Html.Raw(parametros.MuestraStockProducto ? "" : "display: none")"><a href="javascript:;" id="txtIngresoStock" data-type="text" data-pk="4" data-title="Stock">0</a></td>
                                <td style="text-align: right; @Html.Raw(parametros.MuestraUnidadMedidaProducto ? "" : "display: none")"><a href="javascript:;" id="txtIngresoUnidadDeMedida" data-type="text" data-pk="4" data-title="Unidad Medida"></a></td>
                                <td style="text-align: right"><a href="javascript:;" id="txtIngresoNeto" data-type="text" data-pk="4" data-title="Neto">0</a></td>
                                <td style="text-align: right"><a href="javascript:;" id="txtIngresoSubTotal" data-type="text" data-pk="4" data-title="Sub Total">0</a></td>
                                <td style="text-align: right; @Html.Raw(PorcentajeAtributoDescuento > 0 ? "" : "display: none")"><a href="javascript:;" id="txtIngresoDescuentoAtributo" data-type="text" data-pk="4" data-title="Descuento Atributo">0</a></td>
                                <td style="text-align: right">
                                    <a href="javascript:;" id="txtIngresoDescuento" data-pk="4" data-title="Descuento"></a>
                                    <a href="javascript:;" id="txtIngresoDescuentoModal" style="display: none">Seleccionar Descuentos</a>
                                </td>
                                <td style="text-align: right"><a href="javascript:;" id="txtIngresoTotal" data-type="text" data-pk="4" data-title="Total">0</a></td>
                                <td>
                                    <input class="btn btn-primary" type="button" name="Agregar" value="(+)" onclick="addRow();">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="row col-lg-12">
        <div class="col-lg-9">
            <div class="panel panel-inverse" data-sortable-id="ui-widget-3">
                <div class="panel-heading">
                    <h4 class="panel-title">Productos ingresados</h4>
                    <div class="panel-heading-btn">
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>-->
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-success" data-click="panel-reload"><i class="fa fa-redo"></i></a>-->
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>-->
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i class="fa fa-times"></i></a>-->
                    </div>
                </div>
                <div class="panel-body">
                    <!-- begin table-responsive -->
                    <div class="table-responsive">
                        <table id="table" class="table">
                            <thead>
                                <tr>
                                    <th nowrap="" class="codigoTh">C&oacute;digo</th>
                                    <th nowrap="" class="descripcionTh">Descripci&oacute;n</th>
                                    <th nowrap="" class="tallaTh" style="@Html.Raw(parametros.ManejaTallaColor ? "" : "display: none")">Talla</th>
                                    <th nowrap="" class="ColorTh" style="@Html.Raw(parametros.ManejaTallaColor ? "" : "display: none")">Color</th>
                                    <th nowrap="" class="cantidadTh">Cantidad</th>
                                    <th nowrap="" class="unimedTh" style="@Html.Raw(parametros.MuestraUnidadMedidaProducto ? "" : "display: none")">Unidad Medida </th>
                                    <th nowrap="" classnowrap="" class="precioTh">Precio Unit Neto</th>
                                    <th nowrap="" class="subTotalTh">Subtotal Neto</th>
                                    <th nowrap="" class="unimedTh" style="@Html.Raw(PorcentajeAtributoDescuento > 0 ? "" : "display: none")">Descuento Atributo</th>
                                    <th nowrap="" class="subTotalTh">Descu. (%)</th>
                                    <th nowrap="" class="subTotalTh">Total</th>
                                    <th nowrap="" class="accionesTh">&nbsp;</th>
                                </tr>
                            </thead>
                            <tbody id="generaTabla"></tbody>
                        </table>
                    </div>
                    <!-- end table-responsive -->
                </div>
                <!-- end panel-body -->
            </div>
        </div>
        <div class="col-lg-3">
            <div class="panel panel-inverse" data-sortable-id="ui-widget-4">
                <div class="panel-heading">
                    <h4 class="panel-title">TOTALES</h4>
                    <div class="panel-heading-btn">
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>-->
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-success" data-click="panel-reload"><i class="fa fa-redo"></i></a>-->
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>-->
                        <!--<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i class="fa fa-times"></i></a>-->
                    </div>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="table-responsive">
                            <table id="user" class="table table-condensed table-bordered">
                                <tbody>
                                    <tr style="display: none" id="trDescuento1">
                                        <td class="tg-0lax">
                                            <b><span> Descuento N°1</span></b>
                                        </td>
                                        <td style="text-align: right" class="tg-0lax">
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <input class="form-control input-sm" type="text" id="txtDescuentoTotal1" value="0" />
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr style="display: none" id="trDescuento2">
                                        <td class="tg-0lax">
                                            <b><span> Descuento N°2</span></b>
                                        </td>
                                        <td style="text-align: right" class="tg-0lax">
                                            <input class="form-control" type="text" id="txtDescuentoTotal2" value="0" />
                                        </td>
                                    </tr>
                                    <tr style="display: none" id="trDescuento3">
                                        <td class="tg-0lax">
                                            <b><span> Descuento N°3</span></b>
                                        </td>
                                        <td style="text-align: right" class="tg-0lax">
                                            <input class="form-control" type="text" id="txtDescuentoTotal3" value="0" />
                                        </td>
                                    </tr>
                                    <tr style="display: none" id="trDescuento4">
                                        <td class="tg-0lax">
                                            <b><span> Descuento N°4</span></b>
                                        </td>
                                        <td style="text-align: right" class="tg-0lax">
                                            <input class="form-control" type="text" id="txtDescuentoTotal4" value="0" />
                                        </td>
                                    </tr>
                                    <tr style="display: none" id="trDescuento5">
                                        <td class="tg-0lax">
                                            <b><span> Descuento N°5</span></b>
                                        </td>
                                        <td style="text-align: right" class="tg-0lax">
                                            <input class="form-control" type="text" id="txtDescuentoTotal5" value="0" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="tg-0lax">
                                            <input type="hidden" id="contador_registros" name="contador_registros" value=@numero1>
                                            <b><span> Sub-Total Neto</span></b>
                                        </td>
                                        <td style="text-align: right" class="tg-0lax">
                                            <h4><label id="lbtotal">0</label></h4>
                                            <input type="hidden" id="txttotal" name="txttotal" value=@total1>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="tg-0lax">
                                            <b><span> Impuesto</span></b>
                                        </td>
                                        <td style="text-align: right" class="tg-0lax">
                                            <h4><label id="lbimpuesto">0</label></h4>
                                            <input type="hidden" id="txtimpuesto" name="txtimpuesto" value=@impuesto>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="tg-0lax">
                                            <b><span> Total Final</span></b>
                                        </td>
                                        <td style="text-align: right" class="tg-0lax">
                                            <h4><label id="lbtotalfinal">0</label></h4>
                                            <input type="hidden" id="txttotalfinal" name="txttotalfinal" value=@totalfinal>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="row text-center">
                        <input class="btn btn-primary" id="btnCot" type="submit" value="Genera Pedido" onclick="agregarnotadeventa();">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="divAlertaOkGeneracionNV" style="display: none" class="alert alert-success" role="alert">
    <h4 class="alert-heading">Nota de Pedido Generada</h4>
    <p>Nota(s) de pedido generada(s) con exito <label id="divAlertaOkGeneracionNVPendiente">(enviado a aprobacion)</label></p>
    <div class="row" id="divAlertaOkGeneracionNVInterno">
        <div class="col-lg-2">
        </div>
        <div class="col-lg-8">
            <table id="tblResultadoAgregarNV" class="table table-condensed table-bordered">
                <thead>
                    <tr>
                        <th>N° Nota Pedido Interno</th>
                        <th>N° Nota Pedido Softland</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="col-lg-2">
        </div>
    </div>
    <hr>
    <p class="mb-0">Para volver a generar una nueva nota de pedido, presione <a href="javascript:location.reload()">aqui</a>.</p>
</div>
<a id="aModalTallaColor" style="display: none" href="#modalTallaColor" class="btn btn-sm btn-success" data-toggle="modal">Talla Color</a>
<div class="modal fade" id="modalTallaColor">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Ingrese Talla y Color</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-lg-3">Bodegas</div>
                    <div class="col-lg-9">
                        <select id="modalTallaColorBodegas" class="form-control" style="display: none"></select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-12">
                        <div id="modalTallaColorControles"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <a id="modalTallaColorAgregarTallaColor" href="javascript:;" class="btn btn-success">Agregar Talla y Color</a>
                <a id="modalTallaColorCerrar" href="javascript:;" class="btn btn-white" data-dismiss="modal">Cerrar</a>
            </div>
        </div>
    </div>
</div>
<a id="aModalDescuentos" style="display: none" href="#modalDescuentos" class="btn btn-sm btn-success" data-toggle="modal">Descuentos</a>
<div class="modal fade" id="modalDescuentos">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Ingrese descuentos</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            </div>
            <div class="modal-body">
                <div id="modalDescuentosControles"></div>
            </div>
            <div class="modal-footer">
                <a id="modalDescuentosAgregarDescuentos" href="javascript:;" class="btn btn-success">Agregar Descuentos</a>
                <a id="modalDescuentosCerrar" href="javascript:;" class="btn btn-white" data-dismiss="modal">Cerrar</a>
            </div>
        </div>
    </div>
</div>
<a id="aModalDescuentosRealizados" style="display: none" href="#modalDescuentosRealizados" class="btn btn-sm btn-success" data-toggle="modal">Descuentos</a>
<div class="modal fade" id="modalDescuentosRealizados">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Ingrese descuentos</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            </div>
            <div class="modal-body">
                <div id="modalDescuentosRealizadosControles"></div>
            </div>
            <div class="modal-footer">
                <a href="javascript:;" class="btn btn-white" data-dismiss="modal">Cerrar</a>
            </div>
        </div>
    </div>
</div>
<a id="aModalAgregarDireccionDespacho" style="display: none" href="#modalAgregarDireccionDespacho" class="btn btn-sm btn-success" data-toggle="modal">Agregar Direccion Despacho</a>
<div class="modal fade" id="modalAgregarDireccionDespacho">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Ingrese Direccion Despacho</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            </div>
            <div class="modal-body">
                <div class="table-responsive form-inline">
                    <table class="table table-profile">
                        <tbody>
                            <tr class="highlight">
                                <td>Codigo Cliente</td>
                                <td><label id="modalAgregarDireccionDespachoCodigoCliente">@Html.Raw(CodAux)</label></td>
                            </tr>
                            <tr class="highlight">
                                <td>Direccion</td>
                                <td>
                                    <input type="text" id="modalAgregarDireccionDespachoDireccion" class="form-control" />
                                </td>
                            </tr>
                            <tr class="highlight">
                                <td>Ciudad</td>
                                <td>
                                    @Html.DropDownList("modalAgregarDireccionDespachoCiudad", (IEnumerable<SelectListItem>)ViewBag.Ciudad, "Seleccione Ciudad", new { @class = "form-control", @id = "modalAgregarDireccionDespachoCiudad", @name = "modalAgregarDireccionDespachoCiudad" })
                                </td>
                            </tr>
                            <tr class="highlight">
                                <td>Comuna</td>
                                <td>
                                    @Html.DropDownList("modalAgregarDireccionDespachoComuna", (IEnumerable<SelectListItem>)ViewBag.Comuna, "Seleccione Comuna", new { @class = "form-control", @id = "modalAgregarDireccionDespachoComuna", @name = "modalAgregarDireccionDespachoComuna" })
                                </td>
                            </tr>
                            <tr class="highlight">
                                <td colspan="2"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <a id="modalAgregarDireccionDespachoAgregar" href="javascript:;" class="btn btn-success">Agregar Direccion Despacho</a>
                <a id="modalAgregarDireccionDespachoCerrar" href="javascript:;" class="btn btn-white" data-dismiss="modal">Cerrar</a>
            </div>
        </div>
    </div>
</div>
<div id="modalSaldo" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">Detalle Saldo Cliente</h4>
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="x_content">
                    <div class="col-lg-push-12">
                        <div class="table-responsive form-inline">
                            <table id="tblSaldos" class="table table-profile"></table>
                        </div>
                    </div>
                    <br />
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="btnCerrarModal" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>
<!-- end row -->
<!-- end page container -->
<!-- ================== BEGIN BASE JS ================== -->
<script src="~/Content/assets/js/app.min.js"></script>
<script src="~/Content/assets/js/theme/default.min.js"></script>
<!-- ================== END BASE JS ================== -->
<!-- ================== BEGIN PAGE LEVEL JS ================== -->
<script src="~/Content/assets/plugins/jquery-migrate/dist/jquery-migrate.min.js"></script>
<script src="~/Content/assets/plugins/x-editable-bs4/dist/bootstrap4-editable/js/bootstrap-editable.min.js"></script>
<script src="~/Content/assets/plugins/x-editable-bs4/dist/inputs-ext/address/address.js"></script>
<script src="~/Content/assets/plugins/x-editable-bs4/dist/inputs-ext/typeaheadjs/lib/typeahead.js"></script>
<script src="~/Content/assets/plugins/x-editable-bs4/dist/inputs-ext/typeaheadjs/typeaheadjs.js"></script>
<script src="~/Content/assets/plugins/x-editable-bs4/dist/inputs-ext/wysihtml5/wysihtml5.js"></script>
<script src="~/Content/assets/plugins/bootstrap3-wysihtml5-bower/dist/bootstrap3-wysihtml5.all.min.js"></script>
<script src="~/Content/assets/plugins/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
<script src="~/Content/assets/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script src="~/Content/assets/plugins/select2/dist/js/select2.full.min.js"></script>
<script src="~/Content/assets/plugins/jquery-mockjax/dist/jquery.mockjax.min.js"></script>
<script src="~/Content/assets/plugins/moment/moment.js"></script>
<script src="~/WebJs/Venta/NotaDeVenta.js"></script>

<!-- ================== END PAGE LEVEL JS ================== -->
